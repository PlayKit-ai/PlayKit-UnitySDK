---
title: API 参考
description: Developerworks Unity SDK 的完整 API 文档
---

# API 参考

Developerworks Unity SDK 中所有类、方法和类型的完整参考文档。

## 核心类

### DeveloperworksSDK

用于初始化和配置的主 SDK 类。

#### 方法

##### Initialize

使用配置选项初始化 SDK。

```csharp
public static void Initialize(SDKConfig config)
```

**参数：**
- `config` (SDKConfig)：包含 API 凭证和设置的配置对象

**示例：**
```csharp
DeveloperworksSDK.Initialize(new SDKConfig
{
    ApiKey = "your-api-key",
    ApiSecret = "your-api-secret",
    Environment = SDKEnvironment.Production
});
```

##### GetVersion

返回当前 SDK 版本。

```csharp
public static string GetVersion()
```

**返回：**SDK 版本的字符串表示

**示例：**
```csharp
string version = DeveloperworksSDK.GetVersion();
Debug.Log($"SDK 版本：{version}");
```

#### 属性

##### IsInitialized

获取 SDK 是否已初始化。

```csharp
public static bool IsInitialized { get; }
```

##### CurrentConfig

获取当前的 SDK 配置。

```csharp
public static SDKConfig CurrentConfig { get; }
```

#### 事件

##### OnConnectionStateChanged

连接状态变化时触发。

```csharp
public static event Action<ConnectionState> OnConnectionStateChanged;
```

##### OnDataSynced

数据与服务器同步时触发。

```csharp
public static event Action OnDataSynced;
```

---

## 身份验证

### DeveloperworksAuth

处理用户身份验证和会话管理。

#### 方法

##### SignIn

使用邮箱和密码登录用户。

```csharp
public static async Task<AuthResult> SignIn(string username, string password)
```

**参数：**
- `username` (string)：用户的邮箱地址
- `password` (string)：用户的密码

**返回：**包含成功状态和用户数据或错误的 AuthResult

**示例：**
```csharp
var result = await DeveloperworksAuth.SignIn(
    "user@example.com",
    "secure-password"
);

if (result.Success)
{
    Debug.Log($"已登录：{result.User.Email}");
}
```

##### SignInAnonymously

匿名登录，无需凭证。

```csharp
public static async Task<AuthResult> SignInAnonymously()
```

**返回：**包含匿名用户数据的 AuthResult

##### SignInWithProvider

使用第三方身份验证提供商登录。

```csharp
public static async Task<AuthResult> SignInWithProvider(AuthProvider provider)
```

**参数：**
- `provider` (AuthProvider)：要使用的身份验证提供商

**支持的提供商：**
- `AuthProvider.Google`
- `AuthProvider.Facebook`
- `AuthProvider.Twitter`
- `AuthProvider.Apple`
- `AuthProvider.Discord`

##### CreateUser

创建新用户账户。

```csharp
public static async Task<AuthResult> CreateUser(UserRegistration registration)
```

**参数：**
- `registration` (UserRegistration)：包括邮箱、密码和显示名称的注册详情

**示例：**
```csharp
var result = await DeveloperworksAuth.CreateUser(new UserRegistration
{
    Email = "newuser@example.com",
    Password = "secure-password",
    DisplayName = "新用户",
    AcceptedTerms = true
});
```

##### SignOut

登出当前用户。

```csharp
public static async Task SignOut()
```

##### SendPasswordResetEmail

向指定地址发送密码重置邮件。

```csharp
public static async Task SendPasswordResetEmail(string email)
```

**参数：**
- `email` (string)：发送重置链接的邮箱地址

##### ChangePassword

修改当前用户的密码。

```csharp
public static async Task ChangePassword(string currentPassword, string newPassword)
```

**参数：**
- `currentPassword` (string)：当前密码
- `newPassword` (string)：新密码

##### UpdateProfile

更新当前用户的资料。

```csharp
public static async Task UpdateProfile(ProfileUpdate update)
```

**参数：**
- `update` (ProfileUpdate)：要应用的资料更新

**示例：**
```csharp
await DeveloperworksAuth.UpdateProfile(new ProfileUpdate
{
    DisplayName = "更新的名称",
    PhotoUrl = "https://example.com/photo.jpg"
});
```

##### SendEmailVerification

向当前用户发送邮箱验证。

```csharp
public static async Task SendEmailVerification()
```

##### RestoreSession

恢复先前保存的会话。

```csharp
public static async Task<AuthResult> RestoreSession()
```

#### 属性

##### IsAuthenticated

获取用户当前是否已通过身份验证。

```csharp
public static bool IsAuthenticated { get; }
```

##### CurrentUser

获取当前已验证的用户。

```csharp
public static User CurrentUser { get; }
```

##### HasPersistedSession

获取是否存在持久化会话。

```csharp
public static bool HasPersistedSession { get; }
```

#### 事件

##### OnAuthStateChanged

身份验证状态变化时触发。

```csharp
public static event Action<AuthState> OnAuthStateChanged;
```

##### OnTokenRefreshed

身份验证令牌刷新时触发。

```csharp
public static event Action<string> OnTokenRefreshed;
```

##### OnSessionExpired

用户会话过期时触发。

```csharp
public static event Action OnSessionExpired;
```

---

## API 客户端

### DeveloperworksAPI

向 Developerworks 后端进行 API 调用。

#### 方法

##### GetUserData

检索当前用户的数据。

```csharp
public static async Task<UserData> GetUserData()
```

**返回：**包含用户信息的 UserData 对象

**示例：**
```csharp
var data = await DeveloperworksAPI.GetUserData();
Debug.Log($"用户等级：{data.Level}");
```

##### UpdateUserData

更新当前用户的数据。

```csharp
public static async Task<bool> UpdateUserData(UserDataUpdate update)
```

**参数：**
- `update` (UserDataUpdate)：要应用的数据更新

**返回：**成功返回 true，否则返回 false

**示例：**
```csharp
await DeveloperworksAPI.UpdateUserData(new UserDataUpdate
{
    Level = 10,
    Points = 1000
});
```

##### GetLeaderboard

检索排行榜数据。

```csharp
public static async Task<Leaderboard> GetLeaderboard(string leaderboardId, int limit = 100)
```

**参数：**
- `leaderboardId` (string)：排行榜 ID
- `limit` (int)：返回的最大条目数（默认：100）

**返回：**包含条目的 Leaderboard 对象

##### SubmitScore

向排行榜提交分数。

```csharp
public static async Task<LeaderboardEntry> SubmitScore(string leaderboardId, int score)
```

**参数：**
- `leaderboardId` (string)：排行榜 ID
- `score` (int)：要提交的分数

**返回：**显示玩家位置的 LeaderboardEntry

##### GetAchievements

检索当前用户的成就。

```csharp
public static async Task<Achievement[]> GetAchievements()
```

**返回：**Achievement 对象数组

##### UnlockAchievement

为当前用户解锁成就。

```csharp
public static async Task<bool> UnlockAchievement(string achievementId)
```

**参数：**
- `achievementId` (string)：要解锁的成就 ID

**返回：**成功解锁返回 true

---

## 数据类型

### SDKConfig

SDK 的配置选项。

```csharp
public class SDKConfig
{
    public string ApiKey { get; set; }
    public string ApiSecret { get; set; }
    public SDKEnvironment Environment { get; set; }
    public bool EnableLogging { get; set; } = true;
    public TimeSpan Timeout { get; set; } = TimeSpan.FromSeconds(30);
}
```

### User

表示已验证的用户。

```csharp
public class User
{
    public string Id { get; }
    public string Email { get; }
    public string DisplayName { get; }
    public string PhotoUrl { get; }
    public bool IsEmailVerified { get; }
    public DateTime CreatedAt { get; }
    public DateTime LastSignInAt { get; }
}
```

### AuthResult

身份验证操作的结果。

```csharp
public class AuthResult
{
    public bool Success { get; }
    public User User { get; }
    public AuthError Error { get; }
}
```

### UserData

用户的游戏数据。

```csharp
public class UserData
{
    public string UserId { get; }
    public int Level { get; set; }
    public int Points { get; set; }
    public Dictionary<string, object> CustomData { get; set; }
    public DateTime LastUpdated { get; }
}
```

### Achievement

表示游戏成就。

```csharp
public class Achievement
{
    public string Id { get; }
    public string Name { get; }
    public string Description { get; }
    public int Points { get; }
    public bool IsUnlocked { get; }
    public DateTime UnlockedAt { get; }
}
```

### Leaderboard

排行榜数据结构。

```csharp
public class Leaderboard
{
    public string Id { get; }
    public string Name { get; }
    public LeaderboardEntry[] Entries { get; }
    public int TotalEntries { get; }
}
```

### LeaderboardEntry

单个排行榜条目。

```csharp
public class LeaderboardEntry
{
    public int Rank { get; }
    public string UserId { get; }
    public string DisplayName { get; }
    public int Score { get; }
    public DateTime SubmittedAt { get; }
}
```

---

## 枚举

### SDKEnvironment

SDK 环境模式。

```csharp
public enum SDKEnvironment
{
    Development,  // 开发环境
    Staging,      // 预发布环境
    Production    // 生产环境
}
```

### AuthState

身份验证状态。

```csharp
public enum AuthState
{
    SignedOut,      // 已登出
    SignedIn,       // 已登录
    SessionExpired, // 会话已过期
    SigningIn,      // 正在登录
    SigningOut      // 正在登出
}
```

### AuthProvider

第三方身份验证提供商。

```csharp
public enum AuthProvider
{
    Google,
    Facebook,
    Twitter,
    Apple,
    Discord
}
```

### ConnectionState

网络连接状态。

```csharp
public enum ConnectionState
{
    Disconnected,  // 已断开
    Connecting,    // 正在连接
    Connected,     // 已连接
    Reconnecting,  // 正在重连
    Error          // 错误
}
```

### AuthErrorCode

身份验证错误代码。

```csharp
public enum AuthErrorCode
{
    None,                 // 无错误
    InvalidCredentials,   // 凭证无效
    EmailAlreadyExists,   // 邮箱已存在
    WeakPassword,         // 密码强度太弱
    InvalidEmail,         // 邮箱格式无效
    UserNotFound,         // 用户未找到
    NetworkError,         // 网络错误
    SessionExpired,       // 会话已过期
    WrongPassword         // 密码错误
}
```

---

## 异常

### SDKException

SDK 错误的基础异常。

```csharp
public class SDKException : Exception
{
    public SDKErrorCode Code { get; }
    public SDKException(string message, SDKErrorCode code) : base(message) { }
}
```

### AuthException

身份验证操作抛出的异常。

```csharp
public class AuthException : SDKException
{
    public AuthErrorCode AuthCode { get; }
    public AuthException(string message, AuthErrorCode code) : base(message) { }
}
```

### APIException

API 操作抛出的异常。

```csharp
public class APIException : SDKException
{
    public int StatusCode { get; }
    public string ResponseBody { get; }
    public APIException(string message, int statusCode) : base(message) { }
}
```

### ValidationException

验证失败时抛出的异常。

```csharp
public class ValidationException : SDKException
{
    public string[] ValidationErrors { get; }
    public ValidationException(string message, string[] errors) : base(message) { }
}
```

---

## 常量

### API 端点

```csharp
public static class APIEndpoints
{
    public const string Production = "https://api.developerworks.com/v1";
    public const string Staging = "https://staging-api.developerworks.com/v1";
    public const string Development = "https://dev-api.developerworks.com/v1";
}
```

### SDK 版本

```csharp
public static class SDKVersion
{
    public const string Version = "1.0.0";
    public const int MajorVersion = 1;
    public const int MinorVersion = 0;
    public const int PatchVersion = 0;
}
```

---

## 其他资源

<Cards>
  <Card
    title="快速入门"
    description="开始使用 SDK"
    href="/docs/quickstart"
  />
  <Card
    title="身份验证"
    description="了解身份验证功能"
    href="/docs/authentication"
  />
  <Card
    title="安装"
    description="SDK 安装指南"
    href="/docs/installation"
  />
</Cards>

## 支持

有关 API 的问题或问题，请：

- 查看此参考文档
- 回顾[快速入门指南](/docs/quickstart)
- 访问我们的 GitHub 仓库
- 联系我们的支持团队
